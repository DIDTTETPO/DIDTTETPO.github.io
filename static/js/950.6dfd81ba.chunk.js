"use strict";(self.webpackChunkskytime_donate=self.webpackChunkskytime_donate||[]).push([[950],{2950:function(e,n,t){t.r(n);var r=t(3433),i=t(1413),a=t(4165),c=t(5861),s=t(9439),o=t(9267),l=t(6244),u=t(9134),d=t(2982),p=t(4419),h=t(5059),m=t(8910),x=t(320),j=t(6998),f=t(2681),g=t(3241),v=t(2814),Z=t(5428),b=t(4485),k=t(2012),y=t(6573),w=t(2653),_=t.n(w),C=t(7313),I=t(5627),S=t(8467),z=t(8341),K=t(3574),D=t(5407),N=t(6417);n.default=function(e){var n=e.product,t=(0,C.useState)((null===n||void 0===n?void 0:n.commands)||[]),w=(0,s.Z)(t,2),B=w[0],A=w[1],F=(0,C.useState)(""),L=(0,s.Z)(F,2),O=L[0],P=L[1],R=(0,C.useState)([]),T=(0,s.Z)(R,2),U=T[0],X=T[1],E=(0,C.useState)(!!n&&n.changeable_count),J=(0,s.Z)(E,2),M=J[0],V=J[1],q=(0,C.useState)(n?{file:null,url:"https://api.skytime.su"+n.image}:null),G=(0,s.Z)(q,2),H=G[0],Q=G[1],W=(0,C.useContext)(K.I),Y=(0,d.p)();(0,C.useEffect)((function(){var e=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(){var n,t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.Z.get("https://api.skytime.su/admin/categories",{headers:{Authorization:"Bearer ".concat(W.props.auth)}});case 3:n=e.sent,t=n.data,X(t.categories),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),(0,D.Z)(e.t0,Y);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();e()}),[]);var $=(0,I.cI)({defaultValues:{name:(null===n||void 0===n?void 0:n.name)||"",category_id:(null===n||void 0===n?void 0:n.category_id.toString())||"",price:null!==n&&void 0!==n&&n.price?n.price/100:1,normal_price:null!==n&&void 0!==n&&n.normal_price?n.normal_price/100:1}}),ee=$.register,ne=$.handleSubmit,te=$.watch,re=$.formState.isSubmitting,ie=(0,S.s0)();return(0,N.jsxs)(p.K,{direction:"column",spacing:4,children:[(0,N.jsxs)(p.K,{direction:["column","row"],justifyContent:"space-between",spacing:2,children:[(0,N.jsxs)(h.X,{children:[n?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"," \u043f\u0440\u043e\u0434\u0443\u043a\u0442"]}),n&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(m.h,{onClick:(0,c.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.Z.post("https://api.skytime.su/admin/products/delete",{id:n.id},{headers:{Authorization:"Bearer ".concat(W.props.auth)}});case 3:Y({title:"\u0423\u0441\u043f\u0435\u0448\u043d\u043e!",status:"success"}),ie("/admin/products"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),(0,D.Z)(e.t0,Y);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),"aria-label":"",display:["none","block"],children:(0,N.jsx)(o.p,{})}),(0,N.jsx)(x.z,{onClick:(0,c.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.Z.post("https://api.skytime.su/admin/products/delete",{id:n.id},{headers:{Authorization:"Bearer ".concat(W.props.auth)}});case 3:Y({title:"\u0423\u0441\u043f\u0435\u0448\u043d\u043e!",status:"success"}),ie("/admin/products"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),(0,D.Z)(e.t0,Y);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),"aria-label":"",display:["block","none"],children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]})]}),(0,N.jsxs)(p.K,{direction:["column","row"],justifyContent:"space-between",spacing:4,children:[(0,N.jsx)("form",{onSubmit:ne(function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=new FormData,n&&r.append("id",n.id.toString()),H&&H.file&&r.append("image",H.file),r.append("name",t.name),r.append("category_id",t.category_id),r.append("price",(100*t.price).toString()),r.append("normal_price",(100*t.normal_price).toString()),r.append("commands",JSON.stringify(B)),r.append("changeable_count",M?"1":"0"),e.next=12,y.Z.post("https://api.skytime.su/admin/products/".concat(n?"edit":"create"),r,{headers:{Authorization:"Bearer ".concat(W.props.auth)}});case 12:Y({title:"\u0423\u0441\u043f\u0435\u0448\u043d\u043e!",status:"success"}),ie("/admin/products"),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),(0,D.Z)(e.t0,Y);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(n){return e.apply(this,arguments)}}()),children:(0,N.jsxs)(p.K,{direction:"column",spacing:2,children:[(0,N.jsxs)(j.NI,{children:[(0,N.jsx)(f.l,{children:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0430"}),(0,N.jsx)(_(),{placeholder:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435",onFileChange:function(e){return Q({file:e[0],url:URL.createObjectURL(e[0])})},hideClearButton:!0})]}),(0,N.jsxs)(j.NI,{children:[(0,N.jsx)(f.l,{children:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0430"}),(0,N.jsx)(g.I,(0,i.Z)({isDisabled:re,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"},ee("name")))]}),(0,N.jsxs)(j.NI,{children:[(0,N.jsx)(f.l,{children:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f"}),(0,N.jsx)(v.P,(0,i.Z)((0,i.Z)({isDisabled:re,placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044e"},ee("category_id")),{},{children:U.map((function(e){return(0,N.jsx)("option",{value:e.id.toString(),children:e.name})}))}))]}),(0,N.jsxs)(j.NI,{children:[(0,N.jsx)(f.l,{children:"\u0421\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c"}),(0,N.jsx)(g.I,(0,i.Z)({isDisabled:re,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c"},ee("price")))]}),(0,N.jsxs)(j.NI,{children:[(0,N.jsx)(f.l,{children:"\u0421\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c (\u0431\u0435\u0437 \u0441\u043a\u0438\u0434\u043e\u043a)"}),(0,N.jsx)(g.I,(0,i.Z)({isDisabled:re,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c"},ee("normal_price")))]}),(0,N.jsxs)(p.K,{alignItems:"center",direction:"row",spacing:2,children:[(0,N.jsx)(Z.r,{isChecked:M,onChange:function(){return V(!M)},size:"lg",alignItems:"center"}),(0,N.jsx)(b.x,{children:"\u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c \u043c\u0435\u043d\u044f\u0442\u044c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e"})]}),(0,N.jsx)(h.X,{size:"sm",children:"\u041a\u043e\u043c\u0430\u043d\u0434\u044b"}),B.map((function(e){return(0,N.jsxs)(p.K,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[(0,N.jsx)(b.x,{children:e}),(0,N.jsx)(m.h,{onClick:function(){return A(B.filter((function(n){return n!==e})))},"aria-label":"",children:(0,N.jsx)(l.T,{})})]})})),(0,N.jsxs)(p.K,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[(0,N.jsx)(g.I,{value:O,onChange:function(e){return P(e.currentTarget.value)},isDisabled:re,placeholder:"\u041d\u043e\u0432\u0430\u044f \u043a\u043e\u043c\u0430\u043d\u0434\u0430"}),(0,N.jsx)(m.h,{onClick:function(){A([].concat((0,r.Z)(B),[O])),P("")},"aria-label":"",children:(0,N.jsx)(u.n,{})})]}),(0,N.jsx)(x.z,{type:"submit",children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"})]})}),(0,N.jsx)(k.M,{children:(0,N.jsx)(z.Z,{product:{id:0,name:te("name"),image:(null===H||void 0===H?void 0:H.url)||"",description:null,changeable_count:M,normal_price:100*te("normal_price"),price:100*te("price"),category_id:0,commands:B,created_at:"",updated_at:""},isPreview:!0})})]})]})}}}]);